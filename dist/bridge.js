window.addEventListener("message",e=>{if(e.data?.source!=="sniffer-intercept")return;const r=e.data._reqId;chrome.runtime.sendMessage(e.data,o=>{chrome.runtime.lastError||r&&window.postMessage({source:"sniffer-bg",type:"_response",_reqId:r,data:o},"*")})});chrome.runtime.onMessage.addListener(e=>{if(e.source==="sniffer-bg"&&(window.postMessage(e,"*"),e.type==="setMode"))try{e.mode==="replay"?localStorage.setItem("__sniffer__",JSON.stringify({mode:e.mode,entries:e.entries||[],originGroups:e.originGroups||[]})):localStorage.removeItem("__sniffer__")}catch{}});chrome.runtime.sendMessage({source:"sniffer-bridge",type:"init"},e=>{chrome.runtime.lastError||(e?.corner&&window.postMessage({source:"sniffer-bg",type:"setCorner",corner:e.corner},"*"),e?.mode&&window.postMessage({source:"sniffer-bg",type:"setMode",mode:e.mode,entries:e.entries||[],originGroups:e.originGroups||[]},"*"))});
