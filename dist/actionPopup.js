import"./chunks/modulepreload-polyfill-B5Qt9EMX.js";const o=document.querySelectorAll("[data-corner]"),a=document.getElementById("recs");chrome.storage.local.get("snifferCorner",e=>{const r=e.snifferCorner||"br";for(const t of o)t.dataset.corner===r&&t.classList.add("active")});for(const e of o)e.addEventListener("click",()=>{const r=e.dataset.corner;chrome.storage.local.set({snifferCorner:r});for(const t of o)t.classList.toggle("active",t.dataset.corner===r);chrome.tabs.query({active:!0,currentWindow:!0},t=>{const n=t[0];n?.id&&chrome.tabs.sendMessage(n.id,{source:"sniffer-bg",type:"setCorner",corner:r})})});document.getElementById("dashboard").addEventListener("click",()=>{chrome.tabs.query({active:!0,currentWindow:!0},e=>{const r=e[0];chrome.runtime.sendMessage({type:"openDashboard",tabId:r?.id??null}),window.close()})});function c(){chrome.runtime.sendMessage({type:"getState"},e=>{if(!e)return;const r=e.recordings||[];if(r.length===0){a.innerHTML='<div class="empty">No recordings</div>';return}a.innerHTML=r.map(t=>{const n=e.activeReplays?.[t.id],s=e.recording&&e.recordTargetId===t.id;return`<div class="rec" data-id="${t.id}">
        <span class="rec-name">${l(t.name)}</span>
        <button class="rec-btn ${s?"recording":""}" data-action="record" data-id="${t.id}">${s?"Stop":"Rec"}</button>
        <button class="rec-btn ${n?"on":""}" data-action="replay" data-id="${t.id}">${n?"Stop":"Play"}</button>
      </div>`}).join("")})}function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}a.addEventListener("click",e=>{const r=e.target.closest(".rec-btn");if(r){const n=r.dataset.id,s=r.dataset.action;if(s==="replay"){const i=r.classList.contains("on");chrome.runtime.sendMessage({type:i?"stopReplay":"startReplay",recordingId:n},()=>c())}else s==="record"&&(r.classList.contains("recording")?chrome.runtime.sendMessage({type:"stopRecordInto",recordingId:n},()=>c()):chrome.runtime.sendMessage({type:"getState"},d=>{chrome.runtime.sendMessage({type:"startRecord",filters:d?.recordFilters||["xhr","fetch"],targetId:n},()=>c())}));return}const t=e.target.closest(".rec-name");if(t){const n=t.closest(".rec").dataset.id;chrome.runtime.sendMessage({type:"openRecording",recordingId:n}),window.close()}});c();
